
<style type="text/css">

    body > .grid {
      height: 100%;
    }
    #editpage {
      margin-top: 100px;
    }
</style>

<div id="editpage">
    <div class="ui grid">
        <div class="one wide column"></div>
        <div class="seven wide column">
            <button @click="showobj()" class="ui secondary button">Okay </button>
            <component is="header-section" :avatar_img="avatar_img" :input_title="head_title"  @update-title="updateTitleValue"></component>
            <div class="ui divider"></div>

            <div v-for="eachElement in allElements" :key="eachElement.finder">
                <div style="margin-top: 5px; margin-bottom: 5px;" class="ui row centered segments">
                <div class="ui clearing segment"><div class="ui right floated red small button" v-bind:finder="eachElement.finder" v-on:click='removeElement(eachElement.finder)'>删除</div></div>
                <component :is="eachElement.component" :tar_obj="eachElement"></component>
                </div>
            </div> 
        </div>

        <div class="one wide column"></div>
        <div class="six wide column ">
                <div class="ui segment row">
                    <a v-on:click="addToElements('multi')" class="ui red left ribbon label"><i class="plus icon"></i>添加图文</a><p></p>
                    <div id="img-article">
                        <img class="ui small left floated image" src="../../static/assets/images/image.png">
                        <p>Te eum doming eirmod, nominati pertinacia argumentum ad his. Ex eam alia facete scriptorem, est autem aliquip detraxit at. Usu ocurreret referrentur at, cu epicurei appellantur vix. Cum ea laoreet recteque electram, eos choro alterum definiebas in. Vim dolorum definiebas an. Mei ex natum rebum iisque.</p>
                    </div>
                </div>

                <div class="ui segment row">                   
                    <a v-on:click="addToElements('para')" class="ui orange left ribbon label"><i class="plus icon"></i>添加段落</a><p></p>
                    <div id="article" >
                        <img class="ui image" src="../../static/assets/images/short-paragraph.png">
                    </div>
                </div>

                <div class="ui segment row">
                    <a v-on:click="addToElements('image')" class="ui teal left ribbon label"><i class="plus icon"></i>添加图片</a><p></p>
                    <div id="img">
                        <img class="ui image" src="../../static/assets/images/image.png">
                    </div>
                </div>
        </div>
        <div class="one wide column"></div>
    </div>
</div>
<script src="../../static/js/onestory/component/sections/headersection.js"></script>
<script src="../../static/js/onestory/component/sections/imagesection.js"></script>
<script src="../../static/js/onestory/component/sections/multisection.js"></script>
<script src="../../static/js/onestory/component/sections/paragraphsection.js"></script>

<script type="text/javascript">


$(function() {

    //sections declear
    Vue.component('header-section', HeaderSection);
    Vue.component('image-section', ImageSection);
    Vue.component('paragraph-section',ParagraphSection);
    Vue.component('multi-section',MultiSection);

    var today = new Date();
    var thisMonth = today.getMonth()+1;
    var thispage = new Vue({
      delimiters : ['${', '}'],
      el: '#editpage',
      data: {
        show_content_loading: false,
        cleardata: true,
        pass_name: '',
        pass_word: '',
        counter: 0,
        return_info: {},
        passid : '',
        nickname : '',
        avatar_img: '/static/assets/images/avatar/tom.jpg',
        head_title: '',
        allElements: [], //组件池
        pickeddate :  getToday(),
      },

      methods: {
        addToElements: function(type){
            var element = {};
            var _self = this

            switch(type){
                case 'image':
                    element.namespace = 'image';
                    element.component = 'image-section';
                    element.upload_img = '/static/assets/images/image.png';
                    element.upload_file = '';
                    break;
                case 'para':
                    element.namespace = 'para';
                    element.component = 'paragraph-section';
                    element.para = '';
                    break;
                case 'multi':
                    element.namespace = 'multi';
                    element.component = 'multi-section';
                    element.upload_img = '/static/assets/images/image.png';
                    element.upload_file = '';
                    element.para = '';
                    break;
                default:
                    return;
            }
            _self.counter = _self.counter + 1;
            element.finder = _self.counter;
            _self.allElements.push(element);
        },
        removeElement: function(finder){
            var _self = this
            console.log(_self.allElements)

            $.each(_self.allElements, function(index,obj){
                if(finder == obj.finder){
                    _self.allElements.splice(index, 1);
                    console.log(_self.allElements)
                    return false;
                }
            });
        },

        updateTitleValue: function(val){
            var _self = this;
            _self.head_title = val;
        },

        showobj: function(){
            var _self = this
            console.log(_self.head_title);
        },

      }   
    })

});

</script>
